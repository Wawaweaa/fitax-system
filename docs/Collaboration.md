# 项目协作说明

## 角色分工
- **项目需求方（用户）**：负责确认业务需求、提供项目优先级与验收决策；接收每个模块的阶段成果汇报。
- **Codex（GPT-5 Coding Agent）**：负责总体架构设计、开发规划、模块验收与向需求方汇报；输出技术方案与验收意见，确保模块按计划高质量交付。
- **Claude Code**：按照模块化开发规划执行具体编码与测试工作，在每个模块结束时向 Codex 提交开发小结与测试结果。

## 模块化开发流程
1. **规划对齐**：Codex 维护 `docs/module-plan.md` 及相关规划文档，确保模块目标、验收标准、依赖关系清晰。
2. **模块实施**：Claude Code 基于既定规划开发当前模块（按顺序 A → B → C → D → E → F），并完成所需测试。
3. **阶段汇报**：模块开发完成后，Claude Code 提交包含实现要点、变更文件、测试命令及结果的开发小结给 Codex。
4. **验收评审**：Codex 按 PRD、Architecture、Plan 等文档校验实现，给出明确的“通过/不通过”反馈及必要的整改建议。
5. **迭代修正**：若未通过验收，Claude Code 根据反馈修复问题并重新提交；直至 Codex 确认通过。
6. **对外汇报**：每个模块完成验收后，Codex 向需求方同步结果与后续计划，需求方确认后方可进入下一模块。
7. **验收标准预对齐**：在 Claude Code 开始每个模块的编码与测试之前，Codex 需先向 Claude 明确列出该模块的验收标准（覆盖功能范围、测试项、DoD 指标等），避免实现预期不一致。

## 沟通与交付要求
- 任一模块的开发、测试与验收反馈必须在第一时间同步需求方，确保需求确认与变更透明。
- Codex 与 Claude Code 在协作过程中需引用相关文档、测试结果及代码路径，保证记录可追溯。
- 所有规划更新、验收结论和遗留问题应持续维护在 `docs/` 目录内的对应文档（如 `OpenIssues.md`、`Plan.md` 等）。
- 如遇阻塞或需要调整模块顺序，Codex 负责与需求方沟通决策并更新协作文档。
- Codex 的验收反馈需包含：明确的通过/不通过结论、具体问题位置（文件/行/命令输出）、对问题的影响说明、初步成因分析以及可执行的整改建议，避免模糊描述或遗漏关键信息。
- Claude Code 在提交模块小结时必须附带：核心改动说明、涉及文件列表、完整的测试命令与输出摘要（特别是失败用例的堆栈/报错）、以及确认是否已覆盖 PRD/Plan 中的关键验收点。
- Codex 在提出任务时，应在模块规划基础上进一步拆分执行步骤，保证每个子任务具备明确的目标、操作指引与预期结果，减少反复返工。
- 每项任务必须附带清晰的验收标准；若在执行过程中标准需要调整，Codex 应及时同步最新版本。
- 当验收未通过时，Codex 需说明 Claude 当次工作的进展、指出未达标原因、提供验证记录并给出整改建议；若验收标准变更也需同步说明，若不变则重申现有标准。
- Codex 与 Claude 的沟通应尽量遵循稳定的文本结构，明确区分执行要求、验收标准与补充说明，提高信息传达效率。
- 每次沟通需说明意图与执行指引（含具体工作安排和预期结果），避免含糊指令。
- 规范化沟通的目的在于提升整体协作效率，减少不必要的往返与 token 消耗。
- Codex 需对整体开发效率负责：在分派任务与验收反馈时明确解决思路与策略，遇到偏离目标应及时纠偏，避免 Claude 重复无效工作与额外 token 消耗。

## 固定沟通模板

### 模板一：Codex → Claude 任务指派（“任务执行指引模板”）

开头引用：
```
Claude，请按以下计划和要求实施开发、调整和测试：
```

内容结构：
- **背景与目标**：简述当前所处模块、总体目标，确保与模块规划一致。
- **分解计划**：基于模块规划进一步拆分具体子任务，每个子任务需包含：
  - 目标说明
  - 操作指引（命令、修改文件、注意事项）
  - 预期结果与交付物（含日志、截图、验证方式等）
- **测试与验证要点**：罗列需要执行的测试、验证流程及关键观察项。
- **验收标准**：逐条列出，每项包含衡量方式与需要提供的材料；若后续变更需在沟通中明确更新。

结尾引用：
```
完成后用中文给出实施总结，汇报给Codex
请确认上述任务指派是否可以更新到Communication.md
```
如果我（用户）回复确认，执行把当次的任务指派更新到Communication.md，并带上时间戳


### 模板二：Claude → Codex 实施汇报（“实施结果汇报模板”）

开头引用：
```
Codex，本次实施汇报如下：
```

内容结构：
- **执行概览**：对应任务分解逐项说明完成情况、执行命令、修改文件与关键输出。
- **测试与验证**：列出已执行的测试及结果，包含日志、截图、命令等摘要。
- **问题与风险**：若存在未解决问题或潜在风险，需单列说明。

结尾引用：
```
请验收本次实施汇报，按照Collaboration.md的要求给出验收结论
请确认上述实施汇报是否可以更新到Communication.md
```
如果我（用户）回复确认，执行把当次的实施汇报更新到Communication.md，并带上时间戳


### 模板三：Codex → Claude 验收反馈（“验收结论模板”）

开头引用：
```
Claude，以下是验收结论：
```

内容结构：
- **验收结果**：通过或未通过。（若标准有变动需在此说明；若无变动需重申现有标准。）
- **逐项核对**（通过时）：针对每条验收标准，提供对应证据、命令输出或材料引用。
- **进展与差距**（未通过时）：说明当前进展、未达标项、验证记录（含命令/日志）及整改建议。

结尾引用：
- 验收通过：
```
以下新一轮实施计划和要求，请据此实施开发、调整和测试：
...(新指派任务)
请确认上述指派任务是否可以更新到Communication.md
```
如果我（用户）回复确认，执行把当次的实施汇报更新到Communication.md，并带上时间戳

- 验收未通过：
```
请按照上述验收结论调整和实施，按照Collaboration.md中### 模板三：Codex → Claude 验收反馈（“验收结论模板”），汇报给Codex
请确认上述验收反馈是否可以更新到Communication.md
```
如果我（用户）回复确认，执行把当次的实施汇报更新到Communication.md，并带上时间戳


## 当前状态
- 当前处于 **模块 A：wechat_video 全流程** 的开发阶段。
- Claude Code 正根据模块计划执行实现与测试；Codex 将在收到开发小结后进行验收并向需求方汇报。
